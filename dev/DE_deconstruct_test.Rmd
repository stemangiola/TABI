---
title: "Testing model deconstruction"
output: html_notebook
---


```{r setup}
devtools::load_all(".")
library(rstan)
library(here)
library(shinystan)
library(tidyverse)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
```

```{r}
model = stan_model(file = here("dev","DE_sigmoid_deconstruct.stan"))
```


```{r}
data = full_simulator(10,20,
                        horseshoe_hyperprior_params(10), 
                        default_intercept_params(0.5, 0.3), #intercept here is the location of the inflection point
                        sigmoid_link_params(5,3), 
                        #linear_link_params(),
                        #normal_likelihood_params(1)
                        neg_binomial_likelihood_params(2)
                        )
plot_simulated(data)

fit <- sampling(model, data = data$observed, control = list(adapt_delta = 0.9))

evaluation_summary(rstan::extract(fit),true_params = data$true)
```




